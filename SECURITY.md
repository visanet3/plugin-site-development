# üõ°Ô∏è DDoS Protection & Security

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –∑–∞—â–∏—Ç—ã

–ü—Ä–æ–µ–∫—Ç –∑–∞—â–∏—â–µ–Ω –æ—Ç DDoS –∞—Ç–∞–∫ –Ω–∞ **—Ç—Ä–µ—Ö —É—Ä–æ–≤–Ω—è—Ö**:

### 1Ô∏è‚É£ Frontend Protection (–ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Å—Ç–æ—Ä–æ–Ω–∞)
**–§–∞–π–ª**: `src/utils/ddos-protection.ts`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**:
- ‚úÖ Rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É)
- ‚úÖ Browser fingerprinting –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
- ‚úÖ Exponential backoff –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- ‚úÖ –ó–∞—â–∏—Ç–∞ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ DevTools (–∑–∞—â–∏—Ç–∞ –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏)
- ‚úÖ Throttling –∑–∞–ø—Ä–æ—Å–æ–≤ (50ms –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:

```typescript
import { protectedFetch } from '@/utils/ddos-protection';

// –ó–∞—â–∏—â–µ–Ω–Ω—ã–π HTTP –∑–∞–ø—Ä–æ—Å
const response = await protectedFetch('https://api.example.com/data', {
  method: 'POST',
  body: JSON.stringify({ ... })
});

// React Hook –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
import { useProtectedFetch } from '@/hooks/useProtectedFetch';

const MyComponent = () => {
  const { data, loading, error, execute } = useProtectedFetch();
  
  const handleFetch = async () => {
    await execute('https://api.example.com/data');
  };
};
```

**–ó–∞—â–∏—Ç–∞ WebSocket**:
```typescript
import { ProtectedWebSocket } from '@/utils/ddos-protection';

const ws = new ProtectedWebSocket('wss://api.example.com/socket');
ws.connect();
```

### 2Ô∏è‚É£ Backend Protection (–°–µ—Ä–≤–µ—Ä–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞)
**–§–∞–π–ª**: `backend/rate-limiter/index.py`  
**URL**: `https://functions.poehali.dev/09a6bdd6-9592-4225-a3e5-eac400cfdb5e`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**:
- ‚úÖ –ì–∏–±–∫–∏–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ IP-based + User-Agent –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –ë–î
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- ‚úÖ HTTP headers —Å rate limit –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

**Rate Limits –ø–æ —Ç–∏–ø–∞–º**:
| –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ | –õ–∏–º–∏—Ç | –û–∫–Ω–æ |
|------------|-------|------|
| –û–±—ã—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã | 100 req | 60 —Å–µ–∫ |
| –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è | 10 req | 60 —Å–µ–∫ |
| –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ | 5 req | 300 —Å–µ–∫ |
| –§–æ—Ä—É–º (–ø–æ—Å—Ç—ã/–∫–æ–º–º–µ–Ω—Ç—ã) | 30 req | 60 —Å–µ–∫ |
| –ê–¥–º–∏–Ω –∑–∞–ø—Ä–æ—Å—ã | 200 req | 60 —Å–µ–∫ |

**Response Headers**:
```
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 87
X-RateLimit-Reset: 1763943030
Retry-After: 300 (–µ—Å–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)
```

**HTTP Status Codes**:
- `200 OK` - –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω
- `429 Too Many Requests` - –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ 5 –º–∏–Ω)

### 3Ô∏è‚É£ Database Logging
**–¢–∞–±–ª–∏—Ü–∞**: `security_logs`

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
- –ü—Ä–µ–≤—ã—à–µ–Ω–∏—è rate limit
- IP –∞–¥—Ä–µ—Å–∞ –Ω–∞—Ä—É—à–∏—Ç–µ–ª–µ–π
- User-Agent –∞—Ç–∞–∫—É—é—â–∏—Ö
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã**:
```sql
CREATE TABLE security_logs (
    id SERIAL PRIMARY KEY,
    event_type VARCHAR(50) NOT NULL,      -- 'rate_limit_violation'
    client_key VARCHAR(255) NOT NULL,     -- 'IP:hash'
    reason TEXT,                          -- –û–ø–∏—Å–∞–Ω–∏–µ
    user_agent TEXT,                      -- User-Agent
    created_at TIMESTAMP DEFAULT NOW()
);
```

**–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤** (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤):
```sql
SELECT * FROM security_logs 
WHERE event_type = 'rate_limit_violation'
ORDER BY created_at DESC 
LIMIT 100;
```

### 4Ô∏è‚É£ Admin Monitoring Dashboard
**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç**: `src/components/DDoSMonitor.tsx`

–î–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

**–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç**:
- üìä –í—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ
- ‚úÖ –ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- ‚ö†Ô∏è –°—Ç–∞—Ç—É—Å: –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ / –∞—Ç–∞–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–º–∏—Ç–æ–≤

### Frontend
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `src/utils/ddos-protection.ts`:
```typescript
private config: RateLimitConfig = {
  maxRequests: 100,   // –º–∞–∫—Å–∏–º—É–º –∑–∞–ø—Ä–æ—Å–æ–≤
  windowMs: 60000     // –∑–∞ 60 —Å–µ–∫—É–Ω–¥
};
private blockDurationMs = 300000; // –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç
```

### Backend
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `backend/rate-limiter/index.py`:
```python
RATE_LIMITS = {
    'default': {'requests': 100, 'window': 60},
    'auth': {'requests': 10, 'window': 60},
    'withdrawal': {'requests': 5, 'window': 300},
    'forum': {'requests': 30, 'window': 60},
    'admin': {'requests': 200, 'window': 60}
}
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ –∫–æ–¥–µ:
```typescript
import { ddosProtection } from '@/utils/ddos-protection';

const stats = ddosProtection.getStats();
console.log(stats); 
// { total: 15, blocked: 2, active: 13 }
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ –ë–î:
```sql
-- –¢–æ–ø –∞—Ç–∞–∫—É—é—â–∏—Ö IP
SELECT client_key, COUNT(*) as violations
FROM security_logs
WHERE event_type = 'rate_limit_violation'
  AND created_at > NOW() - INTERVAL '1 day'
GROUP BY client_key
ORDER BY violations DESC
LIMIT 10;

-- –ê—Ç–∞–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
SELECT 
    DATE_TRUNC('hour', created_at) as hour,
    COUNT(*) as attacks
FROM security_logs
WHERE event_type = 'rate_limit_violation'
  AND created_at > NOW() - INTERVAL '1 day'
GROUP BY hour
ORDER BY hour;
```

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Ç–∞–∫

### –ï—Å–ª–∏ –∞—Ç–∞–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞** - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –∞—Ç–∞–∫—É—é—â–µ–≥–æ –Ω–∞ 5 –º–∏–Ω—É—Ç
2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ `security_logs`
3. **Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
4. **Admin dashboard** - –∞–¥–º–∏–Ω —É–≤–∏–¥–∏—Ç –∫—Ä–∞—Å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö

### –†—É—á–Ω–∞—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):

```typescript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
localStorage.clear(); // –û—á–∏—Å—Ç–∏—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
location.reload();    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É
```

## üîê Best Practices

1. **–ù–ï —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ –ª–∏–º–∏—Ç—ã —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ** - —ç—Ç–æ –æ—Å–ª–∞–±–∏—Ç –∑–∞—â–∏—Ç—É
2. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ `security_logs` —Ä–∞–∑ –≤ –¥–µ–Ω—å
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã** - –µ—Å–ª–∏ `blocked > 10`, –≤–æ–∑–º–æ–∂–Ω–∞ –∞—Ç–∞–∫–∞
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CDN** - Cloudflare/AWS CloudFront –¥–æ–±–∞–≤—è—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∑–∞—â–∏—Ç—É
5. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ** - —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ —Å–∏—Å—Ç–µ–º—ã –∑–∞—â–∏—Ç—ã

## üìö –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Browser Fingerprinting
–°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –æ—Ç–ø–µ—á–∞—Ç–æ–∫ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ:
- Canvas fingerprinting
- User-Agent
- Screen resolution
- Timezone
- Hardware (CPU cores, memory)
- Language settings

### Client Identification
Backend –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ:
- IP –∞–¥—Ä–µ—Å—É (X-Forwarded-For, X-Real-IP)
- User-Agent hash
- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á: `IP:hash(UA)`

### Exponential Backoff
–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É:
- –ü–æ–ø—ã—Ç–∫–∞ 1: 1 —Å–µ–∫—É–Ω–¥–∞
- –ü–æ–ø—ã—Ç–∫–∞ 2: 2 —Å–µ–∫—É–Ω–¥—ã
- –ü–æ–ø—ã—Ç–∫–∞ 3: 4 —Å–µ–∫—É–Ω–¥—ã
- –ú–∞–∫—Å–∏–º—É–º: 30 —Å–µ–∫—É–Ω–¥

### Request Timeout
–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–º–µ—é—Ç —Ç–∞–π–º–∞—É—Ç **15 —Å–µ–∫—É–Ω–¥** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è slowloris –∞—Ç–∞–∫.

## üÜò Troubleshooting

**–ü—Ä–æ–±–ª–µ–º–∞**: –õ–µ–≥–∏—Ç–∏–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–∏–ø–∞ –∑–∞–ø—Ä–æ—Å–æ–≤.

**–ü—Ä–æ–±–ª–µ–º–∞**: DDoS Monitor –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç —Ä–æ–ª—å `admin` –≤ –ë–î.

**–ü—Ä–æ–±–ª–µ–º–∞**: –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ**: –£–≤–µ–ª–∏—á—å—Ç–µ `suspiciousThreshold` –≤ `ddos-protection.ts`.

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏–ª–∏ –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ Telegram: https://t.me/+QgiLIa1gFRY4Y2Iy

---

**–í–µ—Ä—Å–∏—è**: 1.0.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 24 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
